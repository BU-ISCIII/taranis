name: tests ci
# This workflow runs the pipeline with the minimal test dataset to check 
# is completed without any errors
on:
    pull_request:
    push:

jobs:
  test_ci:
    name: Code testing
    runs-on: ubuntu-latest
    
    steps:
      - name: Check out pipeline code
        uses: actions/checkout@v4

      - name: Install dependencies
        run: $CONDA/bin/conda env update --file environment.yml --name base

      - name: init conda
        run: conda init

      - name: activate conda
        run: conda activate base

      - name: Install taranis
        run: pip install .

      - name: test analyze schema
        run: taranis analyze-schema -i  test/MLST_listeria -o analyze_schema_test  --cpus 1